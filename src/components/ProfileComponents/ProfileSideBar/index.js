import React, { useEffect, useState } from "react";
import { useLocation } from "react-router";
import { Link, useSearchParams } from "react-router-dom";

//Router
import router from "@utils/router";

//Modals
import LogoutModal from "@components/Modals/LogoutModal";

//Styles
import "./ProfileSideBar.scss";

const historyRouter = [
    {
        url: router.profile_edit,
        svg: (
            <svg
                width="14"
                height="15"
                viewBox="0 0 14 15"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M7 0.75C3.11719 0.75 0 3.89453 0 7.75C0 11.6328 3.11719 14.75 7 14.75C10.8555 14.75 14 11.6328 14 7.75C14 3.89453 10.8555 0.75 7 0.75ZM7 13.875C5.6875 13.875 4.48438 13.4922 3.5 12.8086C3.60938 11.4414 4.73047 10.375 6.125 10.375H7.875C9.24219 10.375 10.3633 11.4414 10.4727 12.8086C9.48828 13.4922 8.28516 13.875 7 13.875ZM11.2383 12.1523C10.8555 10.6484 9.48828 9.5 7.875 9.5H6.125C4.48438 9.5 3.11719 10.6484 2.73438 12.1523C1.58594 11.0312 0.875 9.47266 0.875 7.75C0.875 4.38672 3.60938 1.625 7 1.625C10.3633 1.625 13.125 4.38672 13.125 7.75C13.125 9.47266 12.3867 11.0312 11.2383 12.1523ZM7 4.25C5.76953 4.25 4.8125 5.23438 4.8125 6.4375C4.8125 7.66797 5.76953 8.625 7 8.625C8.20312 8.625 9.1875 7.66797 9.1875 6.4375C9.1875 5.23438 8.20312 4.25 7 4.25ZM7 7.75C6.26172 7.75 5.6875 7.17578 5.6875 6.4375C5.6875 5.72656 6.26172 5.125 7 5.125C7.71094 5.125 8.3125 5.72656 8.3125 6.4375C8.3125 7.17578 7.71094 7.75 7 7.75Z"
                    fill="#09090E"
                />
            </svg>
        ),
        type: "user-info",
        title: "Профиль",
    },
    {
        url: router.profile_password,
        svg: (
            <svg
                width="14"
                height="15"
                viewBox="0 0 14 15"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
            >
                <path
                    d="M9.40625 4.1875C9.40625 3.83203 9.67969 3.53125 10.0625 3.53125C10.418 3.53125 10.7188 3.83203 10.7188 4.1875C10.7188 4.57031 10.418 4.84375 10.0625 4.84375C9.67969 4.84375 9.40625 4.57031 9.40625 4.1875ZM9.1875 9.875C8.91406 9.875 8.66797 9.875 8.42188 9.82031L7.65625 10.5586C7.54688 10.6953 7.38281 10.75 7.21875 10.75H6.125V11.8438C6.125 12.2266 5.82422 12.5 5.46875 12.5H4.375V13.5938C4.375 13.9766 4.07422 14.25 3.71875 14.25H0.65625C0.273438 14.25 0 13.9766 0 13.5938V10.9688C0 10.8047 0.0546875 10.6406 0.191406 10.5039L4.48438 6.21094C4.40234 5.82812 4.375 5.47266 4.375 5.0625C4.375 2.41016 6.50781 0.25 9.1875 0.25C11.8398 0.25 14 2.41016 14 5.0625C14 7.74219 11.8398 9.875 9.1875 9.875ZM9.1875 9C11.3477 9 13.125 7.25 13.125 5.0625C13.125 2.90234 11.3477 1.125 9.1875 1.125C7 1.125 5.25 2.90234 5.25 5.0625C5.25 5.39062 5.27734 5.69141 5.33203 5.99219L5.46875 6.48438L0.875 11.0781V13.375H3.5V11.625H5.25V9.875H7.10938L8.12109 8.89062L8.55859 8.97266C8.75 9 8.96875 9 9.1875 9Z"
                    fill="#09090E"
                />
            </svg>
        ),
        type: "password",
        title: "Пароль",
    },
];

const SideBar = () => {
    const location = useLocation();
    const [searchParams, setSearchParams] = useSearchParams();
    const [type, setType] = useState();
    const [logout, setLogout] = useState(false);

    useEffect(() => {
        if (location.search) {
            setType(searchParams.get("type"));
        }
    }, [location.search]);

    const handleChange = (toggle) => {
        setLogout(false);
    };

    return (
        <div className="profile_sidebar">
            <nav className="profile_sidebar__links">
                {historyRouter.map((e) => (
                    <Link
                        className={
                            e.url === "/profile?type=" + type ? "active" : ""
                        }
                        to={e.url}
                    >
                        {e.svg}
                        {e.title}
                    </Link>
                ))}
                <button onClick={() => setLogout(true)}>
                    <svg
                        width="14"
                        height="13"
                        viewBox="0 0 14 13"
                        fill="none"
                        xmlns="http://www.w3.org/2000/svg"
                    >
                        <path
                            d="M4.8125 11.5H2.1875C1.44922 11.5 0.875 10.9258 0.875 10.1875V2.3125C0.875 1.60156 1.44922 1 2.1875 1H4.8125C5.03125 1 5.25 0.808594 5.25 0.5625C5.25 0.34375 5.03125 0.125 4.8125 0.125H2.1875C0.957031 0.125 0 1.10938 0 2.3125V10.1875C0 11.418 0.957031 12.375 2.1875 12.375H4.8125C5.03125 12.375 5.25 12.1836 5.25 11.9375C5.25 11.7188 5.03125 11.5 4.8125 11.5ZM13.7266 5.64844L10.2266 2.14844C9.98047 1.90234 9.59766 1.82031 9.26953 1.95703C8.94141 2.09375 8.75 2.42188 8.75 2.75V4.5H4.8125C4.07422 4.5 3.5 5.10156 3.5 5.8125V6.6875C3.5 7.42578 4.07422 8 4.8125 8H8.75V9.75C8.75 10.1055 8.94141 10.4336 9.26953 10.5703C9.59766 10.707 9.98047 10.625 10.2266 10.3789L13.7266 6.87891C13.8906 6.71484 14 6.49609 14 6.25C14 6.03125 13.8906 5.8125 13.7266 5.64844ZM9.625 9.75V7.125H4.8125C4.56641 7.125 4.375 6.93359 4.375 6.6875V5.8125C4.375 5.59375 4.56641 5.375 4.8125 5.375H9.625L9.59766 2.75L13.0977 6.25L9.625 9.75Z"
                            fill="#09090E"
                        />
                    </svg>
                    Выйти
                </button>
            </nav>
            {logout ? <LogoutModal handleChange={handleChange} /> : null}
        </div>
    );
};

export default SideBar;
